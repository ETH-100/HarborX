<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />

  <title>HarborX SQL</title>
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, sans-serif;
      max-width: 1100px;
      margin: 32px auto;
      padding: 0 16px
    }

    textarea {
      width: 100%;
      min-height: 160px;
      font-family: ui-monospace, Consolas, monospace;
      font-size: 14px
    }

    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 12px
    }

    th,
    td {
      border: 1px solid #ddd;
      padding: 6px 8px;
      font-size: 13px;
      vertical-align: top
    }

    th {
      background: #f5f5f5;
      text-align: left;
      position: sticky;
      top: 0
    }

    .row {
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
      margin-bottom: 10px
    }

    .muted {
      color: #666
    }

    .btn {
      padding: 8px 14px;
      border: 1px solid #ccc;
      background: #fff;
      border-radius: 6px;
      cursor: pointer
    }

    .btn:hover {
      background: #f7f7f7
    }

    .pill {
      padding: 4px 8px;
      border-radius: 999px;
      background: #f0f0f0
    }

    .error {
      color: #b00020;
      white-space: pre-wrap
    }

    .mono {
      font-family: ui-monospace, Consolas, monospace
    }

    .footer {
      margin-top: 18px;
      color: #888;
      font-size: 12px
    }
  </style>
</head>

<body>
  <h1>HarborX SQL</h1>
  <p class="muted">Loads Arrow/Parquet produced from real rollup blobs (EIP-4844) and builds a <code>state</code> view
    in DuckDB-WASM.</p>
  <div class="row" style="margin:12px 0">
    <span id="status" class="pill">Bootingâ€¦</span>
    <span id="meta" class="muted"></span>
  </div>
  <div class="row">
    <label>Examples:</label>
    <select id="examples">
      <option value="">-- choose --</option>
      <option value="SELECT COUNT(*) AS rows FROM storage_diffs;">storage_diffs: COUNT(*)</option>
      <option value="SELECT address, COUNT(*) AS writes FROM storage_diffs GROUP BY 1 ORDER BY 2 DESC LIMIT 20;">Top
        writers</option>
      <option value="SELECT class_hash, COUNT(*) AS cnt FROM deployed_or_replaced GROUP BY 1 ORDER BY 2 DESC LIMIT 20;">
        Deploy/Replace top</option>
      <option value="SELECT class_hash, compiled_class_hash FROM declared_classes LIMIT 50;">Declared classes</option>
      <option value="SELECT contract_address, nonce FROM nonces LIMIT 50;">Nonces sample</option>
    </select>
    <button class="btn" id="fill">Insert</button>
    <button class="btn" id="init" title="Reload tables from _tables.json">Reload tables</button>
  </div>
  <textarea id="sql" placeholder="Write your SQL here..."></textarea>
  <div class="row" style="margin-top:8px">
    <button class="btn" id="run">Run</button>
    <span class="muted">Use LIMIT for large outputs.</span>
  </div>
  <div id="error" class="error"></div>
  <div id="result"></div>
  <div class="footer">
    <span class="mono">manifest</span> is fetched from <code>data/manifest.json</code> (Arrow first, Parquet fallback).
  </div>
  <script type="module" src="./app.js"></script>
</body>

</html>